name: Fetch_TVBox_Configs

on:
  workflow_dispatch:  # æ‰‹åŠ¨è§¦å‘
  schedule:
    - cron: '0 2 * * *'  # æ¯å¤© UTC 02:00 è‡ªåŠ¨è¿è¡Œï¼ˆå¯é€‰ï¼Œå¯åˆ é™¤ï¼‰

jobs:
  fetch-and-run:
    runs-on: ubuntu-latest

    steps:
      - name: æ£€å‡ºä»£ç ï¼ˆå¸¦å®Œæ•´ Git å†å²ï¼Œç”¨äºæäº¤ï¼‰
        uses: actions/checkout@v3
        with:
          ref: main  # æˆ– mergeï¼Œæ ¹æ®æ‚¨çš„åˆ†æ”¯
          token: ${{ secrets.MY_GH_TOKEN }}
          fetch-depth: 0

      - name: è®¾ç½® Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: å®‰è£…ä¾èµ–
        run: |
          pip install requests

      # ğŸ”¥ æ–°å¢ï¼šé…ç½® Git ç”¨æˆ·ä¿¡æ¯
      - name: é…ç½® Git ç”¨æˆ·åå’Œé‚®ç®±
        run: |
          git config --global user.email "745425103@qq.com"  # æ›¿æ¢ä¸ºçœŸå®é‚®ç®±
          git config --global user.name "leexuben"    # æ›¿æ¢ä¸ºçœŸå®ç”¨æˆ·å

      - name: è¿è¡Œè„šæœ¬ï¼Œç”Ÿæˆå¹¶è‡ªåŠ¨æäº¤ tvbox_raw_sources.txt
        env:
          MY_GH_TOKEN: ${{ secrets.MY_GH_TOKEN }}
        run: |
          python merge/fetch_tvbox_raw_urls.py
